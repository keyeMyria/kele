{% extends 'wxchat/wxbase.html' %}{% load static %}

{% block extra %}
    <link rel="stylesheet" href="{% static 'wxchat/style/style_food.css' %}">
    <style>
    html, body{
        background-color: #fccf5c;
    }
    .cardBg{
        background-color: #fccf5c;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        max-width: 23.5em;
        max-height: 38.4375em;
        z-index: 0;
        right: 0;
        margin: auto;
        background: url({% static 'wxchat/images/card_bg.png' %}) no-repeat;
        background-size: 100% auto;
        -moz-background-size: 100% auto;
        -webkit-background-size: 100% auto;
    }

    .check_label{
        height: 40px;
        line-height: 40px;
        padding: 0;
        padding-left:55px;
        margin-top:20px;
    }
    .check_label:first-child{
        margin-top:34px;
    }
    .check_label:active{
         background-color: transparent;
    }
    </style>
{% endblock extra %}
{% block container %}
<div class="weui-panel cardBg" >
    <div class="weui-panel__hd">
        <div class="weui-flex">
            <div></div>
            <div class="weui-flex__item" style="text-align: center;"></div>
            <div ><a href="{% url 'dog-index' %}?next={{ request.get_full_path }}"><i class="icon iconfont icon-shouye2 pink r" ></i></a></div>
        </div>
    </div>
    <div class="weui-panel__bd" style="color: #3a1437;">
        <form action="" method="post" enctype="multipart/form-data" id="form1" >{% csrf_token %}
        {% for order in orders %}
            <div id="sort_{{ order.sort }}" style="position: absolute;width:18.563em;max-height:27.188em;left: 2.5em;top: 6.25em;" {% if not forloop.first %} class="hide" {% endif %}>
                <div class="weui-cells__title" style="padding-left:5px;padding-right:5px;height: 4.8em;line-height: 4.8em;color: #3a1437;text-align: center;font-size: 1.5625em;margin-top: 6px;margin-bottom:0px;" >{{ order.sort }}.{{ order.name }}</div>
                <div class="weui-cells weui-cells_checkbox" style="background-color: transparent;height:307px;">
                    {% for s in order.dogstatustype.all %}
                        <label class="weui-cell weui-check__label check_label" for="id_{{s.id}}" >
                            <div class="weui-cell__hd">
                                {% if order.is_checkbox == 1 %}
                                    <input type="checkbox" class="weui-check" name="radio_{{order.sort}}_{{ order.id }}" id="id_{{s.id}}" data-item="sort_{{ order.sort }}" value="{{ s.name }}">
                                {% else %}
                                    <input type="radio" class="weui-check" name="radio_{{order.sort}}_{{ order.id }}" id="id_{{s.id}}" data-item="sort_{{ order.sort }}" value="{{ s.name }}">
                                {% endif %}
                                <i class="weui-icon-checked"></i>
                            </div>
                            <div class="weui-cell__bd">
                                <p>{{ s.name }} {{ order.suffix_name }}</p>
                            </div>
                        </label>
                    {% endfor %}
                    <div class="weui-flex" style="position: absolute; bottom:10px;width:100%">
                         {% if not forloop.first %}
                            <div class="weui-flex__item" style="text-align: center"><a href="javascript:void(0);" class="weui-btn weui-btn_mini weui-btn_primary" style="margin-top: 0px;" id="prev_{{ order.sort }}">上一页</a></div>
                         {% endif %}

                        {% if not forloop.last %}
                            <div class="weui-flex__item" style="text-align: center"><a href="javascript:void(0);" class="weui-btn weui-btn_mini weui-btn_primary" id="next_{{ order.sort }}">下一页</a></div>
                         {% endif %}
                         {% if forloop.last %}
                            <div class="weui-flex__item" style="text-align: center"><a href="javascript:void(0);" class="weui-btn weui-btn_mini weui-btn_primary" id="submit_form">提交</a></div>
                         {% endif %}

                    </div>
                </div>
            </div>
        {% endfor %}
        </form>
    </div>
</div>
    <script>
        $(function() {
            $("input[name^='radio_']").on("click", function () {
                var len = {{ orders|length }} ;
                var idx = $(this).attr("data-item");
                idx = idx.split('_')[1];
                var idx2 = idx * 1 + 1;
                setTimeout(function () {
                    if (idx == len) {
                        return false;
                    } else {
{#                        $("#sort_" + idx + "").hide();#}
{#                        $("#sort_" + idx2 + "").show();#}
                    }
                }, 500)
            });

            $("#submit_form").on("click",function(){
                $("#form1").action = "{% url 'dog-order' %}";
                $("#form1").submit();
            });

            $("a[id^='next_']").on("click", function(){
                var page_id = $(this).attr("id");
                var id = page_id.split('_')[1];
                var next_id = parseInt(id) + 1;

                $("#sort_" + id).hide();
                $("#sort_" + next_id).show();

            });

            $("a[id^='prev_']").on("click", function () {
                var page_id = $(this).attr("id");
                var id = page_id.split('_')[1];
                var prev_id = parseInt(id) - 1;

                $("#sort_" + id).hide();
                $("#sort_" + prev_id).show();

            });

        });

    </script>


{% endblock container %}
